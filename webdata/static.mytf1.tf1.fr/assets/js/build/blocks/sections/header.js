define(["lib/searchinput"],function(e){function t(){return this.checkDevice(),this.initHeader(),this.checkAuth(),"undefined"==typeof Cowboy?(window.addEventListener("scroll",function(){this.eventScroll()}.bind(this)),this.eventScroll()):(window.addEventListener("scroll",Cowboy.throttle(200,function(){this.eventScroll()}.bind(this)),!1),this.eventScroll()),this}var n={body:null,arrow:null,header:null,wrapper:null,userContainer:null,btnConnect:null,userNameDesktop:null,userNameMobile:null,popin:null,popinOverlay:null},o="responsive_desktop",s={breakpoint:0,hidden:!1,last_scroll:0,up_scroll:0};return t.prototype.checkDevice=function(){var e={};class_userlib&&(e=class_userlib.getDevice()),"mobile"===e.type?o="responsive_smartphone":"tablet"===e.type&&(o="responsive_tablette")},t.prototype.initElements=function(){n.body=document.getElementsByTagName("body")[0],n.arrow=document.getElementById("header_arrow"),n.header=document.getElementById("TF1__header"),n.wrapper=document.getElementById("wrapper"),n.userContainer=document.getElementById("connected"),n.btnConnect=document.getElementsByClassName("toConnect"),n.userNameDesktop=document.querySelectorAll(".name .full")[0],n.userNameMobile=document.querySelectorAll(".name .initial")[0],n.popin=document.getElementById("popinSubscribe"),n.popinOverlay=document.getElementById("popinOverlay"),n.logout=document.getElementsByClassName("unlogUser")},t.prototype.initOptions=function(){s.breakpoint=0,s.hidden=!1,s.last_scroll=0,s.up_scroll=0},t.prototype.initHeader=function(){this.initElements(),this.initOptions();var t,i,r=n.body.getAttribute("class")&&n.body.getAttribute("class").match(/(\bskin_)\w+\b/g)?n.body.getAttribute("class").match(/(\bskin_)\w+\b/g)[0]:"skin_default";switch(r){case"skin_homepage":t=document.getElementById("caroussel");break;case"skin_showpage":t=document.getElementById("cover")}t&&(i=t.offsetTop+t.offsetHeight),s.breakpoint=i||0,this.header_search_input=new e(n.header),n.arrow.addEventListener("click",function(){utils.toggleClass(n.body,"header-opened")}.bind(this),!0);for(var l=0,a=n.btnConnect.length-1;a>=l;l++){var c=n.btnConnect[l];c.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("data-access")||!1,n=document.body.getAttribute("data-channel")||!1,s=document.body.getAttribute("data-program")||!1,i="/connecting?redirectUri="+encodeURIComponent(window.location.href)+"&device="+o;t&&(i+="&accessId="+t),n&&(i+="&channel="+n),s&&(i+="&program="+s),window.location=i},!0)}},t.prototype.eventScroll=function(){var e=utils.scrollY(),t=s.up_scroll>=s.breakpoint?200:0;e>s.last_scroll&&e>s.breakpoint&&!s.hidden?e>Math.max(s.up_scroll,s.breakpoint)+t&&(utils.addClass(n.body,"header-hidden"),utils.removeClass(n.body,"header-opened"),s.hidden=!0):e<s.last_scroll&&(s.hidden&&(utils.removeClass(n.body,"header-hidden"),s.hidden=!1),s.up_scroll=e),s.last_scroll=e},t.prototype.checkAuth=function(){if(class_userlib.isAuthenticated()){this.setHeaderUserName();var e=document.getElementById("myFavs")||!1;e&&(utils.removeClass(e,"noPajax"),class_page.addJavascriptLink(e));for(var t=0,o=n.btnConnect.length-1;o>=t;t++){var s=n.btnConnect[t];s.style.display="none"}}},t.prototype.setHeaderUserName=function(){var e=class_userlib.getCookie("session");session=JSON.parse(utils.decode64(e)),firstName=session.firstName||"",lastName=session.lastName||"",n.userContainer.style.display="inline-block",n.userNameDesktop.innerHTML=firstName.length>10?firstName.substr(0,10)+"...":firstName,n.userNameMobile.innerHTML=firstName[0]+"."+lastName[0]},t});