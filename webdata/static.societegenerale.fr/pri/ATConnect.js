//-- ATConnect 2.2.012b  -- Copyright 2010 AT INTERNET, All Rights Reserved.
//-- (to be used with AT Tag 3.4.009 or later)

//Criteo 
var partnerID = -1, widgetIDs = [-1,-1,-1], partnerName = '', partnerPool = '';
//NextPerformance
var nextPerformance_ID = -1;
//MyThings
var mtAdvertiserToken = '';
//AreYouNet
var AreyounetConfig = {
    active: false,
    conditions: [     
        {val: '', cond: /.*/, occur: 1, col: 1, pos: 1},       
    ],    
    constraints: [		        
        {cond: '',  prior:1, url: '', validation: '', endOfSession: false}
    ],
    collect: [
		{ name: '',	separ: '|',	col: 1 },
	],
    identifier: { val: 'xtvid', name: 'external_id' },
    htmlelement: '',
    idelement: '',
    confirmtext: '',
    endOfSessionConfirmation: '',
    cookieDuration: -1
}
//Struq
var Struq_Token = '';
//Weborama
var Id_Weborama=435236;
var Client_Weborama='societegenerale.solution.weborama.fr';
//TouchCommerce
var TouchCommerceAdId=-1;

//do not modify below
var c2cDisplayed=null,c2cClickedListener=null,InqRegistry=null,MyTrack=null,mtHost=null,mtScriptInjectionMode=true,xtpview=undefined,xtpcart=undefined,xtporder=undefined,wbHost=xw.xtsd+'.xiti.com/hit.xiti',adp_request=null;
var xtPart=function(){var First=false,xtatid=xtf1('xtatid');if(!xtatid){First=true;xtatid=xt21.getTime()+''+xt_rd(6)}var xtexp=new Date();xtexp.setMinutes(xtexp.getMinutes()+30);wck('xtatid',xtatid,xtexp,'',1);if(mtAdvertiserToken.length>0){mtHost=(('https:'==document.location.protocol)?'https://rainbowx':'https://rainbow')+'.mythings.com';var at=document.createElement('script');at.type='text/javascript';at.async=true;at.src=mtHost+"/c.aspx?atok="+mtAdvertiserToken;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]||document.getElementsByTagName('script')[0].parentNode).insertBefore(at,null);MyTrack=new Array;MyTrack['1010']={Products:[],Active:'0'};MyTrack['200']={Active:'0'};MyTrack['100']={Active:'0'};MyTrack['1013']={Products:[],Active:'0'};MyTrack['9902']={Products:[],TransactionReference:'',TransactionAmount:'',Active:'0'};var Action=First?'200':'100';MyTrack[Action].Active='1'}if(Id_Weborama>-1){var tlib=xtpage.split(/::/gi);if(First){var xtwd=xtf1('xtwd');if(!xtwd){xtwd='0'}wck('xtwd',Math.round(new Date().getTime()/1000),xt29,'',1);adp_request={analytics:{fullhost:Client_Weborama,id:Id_Weborama,section:tlib[tlib.length-2]||'',subsection:tlib[tlib.length-1]||'',postview_url:wbHost+'?s='+xtsite+'&type=wbo&vid='+xtvid+'&ocd='+xtwd+'&wbo='}}}else{adp_request={analytics:{fullhost:Client_Weborama,id:Id_Weborama,section:tlib[tlib.length-2]||'',subsection:tlib[tlib.length-1]||''}}}var atw=document.createElement('script');atw.type='text/javascript';atw.async=true;atw.src=('https:'==document.location.protocol?'https://ssl.weborama.fr/js/analytics.js':'https://cstatic.weborama.fr/js/analytics.js');(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]||document.getElementsByTagName('script')[0].parentNode).insertBefore(atw,null)}if(TouchCommerceAdId>-1){c2cDisplayed={onC2CDisplayed:function(evt){var disImg=new Image();disImg.src=xt7+'.xiti.com/get.ad?xts='+xt8+'&ati=INT-'+TouchCommerceAdId+'&type=AT&rn='+xt_rd(9)+'&url='+xt7+'.xiti.com/hit.xiti';disImg.onload=function(){disImg.onload=null}}};c2cClickedListener={onC2CClicked:function(evt){var clickImg=new Image();clickImg.src=xt7+'.xiti.com/go.ad?xts='+xt8+'&atc=INT-'+TouchCommerceAdId+'&type=AT&rn='+xt_rd(9)+'&url='+xt7+'.xiti.com/hit.xiti';clickImg.onload=function(){clickImg.onload=null}}};InqRegistry={listeners:[c2cDisplayed,c2cClickedListener]}}var pdtab=null,xtpdta='',xtpdtv='',xtimg=null,xtimg2=null,xtdis=true,xtdis2=true,xtl=0,ProductsConv=[],ProductsCart=[],str=xt16,sl_dis=0,sl_tot=0;try{pdtab=(str.replace(/(\[[^\]]*\])/g,'')).match(/&pdt[^&]+/g)}catch(e){}if(pdtab){xtpcart=new Array();xtporder=new Array();for(var i=0;i<pdtab.length;i++){var pdt=pdtab[i].split(/[(::)=]+/g);xtpcart.push(pdt[pdt.length-1]);xtpdta+='&i'+pdt[0].match(/\d+/g)[0]+'=';xtpdta+=pdt[pdt.length-1];var unp=null,unpexpr='&mt'+pdt[0].match(/\d+/g)[0]+'[^&:]+',xtregunp=new RegExp(unpexpr,'g');var qtt=null,qttexpr='&qte'+pdt[0].match(/\d+/g)[0]+'[^&:]+',xtregqtt=new RegExp(qttexpr,'g');var dsc=null,dscexpr='&dsc'+pdt[0].match(/\d+/g)[0]+'[^&:]+',xtregdsc=new RegExp(dscexpr,'g');try{unp=(str.match(xtregunp)[0].split(/=/g)[1]).replace(',','.')}catch(e){}try{qtt=(str.match(xtregqtt)[0].split(/=/g)[1]).replace(',','.')}catch(e){}try{dsc=(str.match(xtregdsc)[0].split(/=/g)[1]).replace(',','.')}catch(e){}try{sl_tot+=parseFloat(unp)*parseInt(qtt,10)}catch(e){}try{sl_dis+=parseFloat(dsc)*parseInt(qtt,10)}catch(e){}xtpdta+=unp?'&p'+pdt[0].match(/\d+/g)[0]+'='+unp:'';xtpdta+=qtt?'&q'+pdt[0].match(/\d+/g)[0]+'='+qtt:'';ProductsConv.push({id:pdt[pdt.length-1],price:unp,qty:qtt});ProductsCart.push({ProductId:pdt[pdt.length-1],Price:unp,Qty:qtt})}}if(xtpdta.length>0){if((typeof(xt_orderid)!='undefined')&&(xt_orderid.length>0)&&((typeof(xt_status)=='undefined')||(xt_status!='2'))){if(partnerID>-1){xtimg=new Image();xtimg.src='https://sslwidget.criteo.com/'+partnerPool+'/display.js?p1='+escape('v=2&wi='+widgetIDs[1]+'&t='+xt_orderid+'&s=1'+xtpdta)+'&t1=transaction&resptype=gif&cb='+xt_rd(11);xtimg.onload=function(){xtimg.onload=null}}if(mtAdvertiserToken.length>0){MyTrack['9902'].Active='1';MyTrack['9902'].Products=ProductsConv;MyTrack['9902'].TransactionReference=xt_orderid;MyTrack['9902'].TransactionAmount=(typeof(xt_roimt)!="undefined")?xt_roimt:''}if(Struq_Token.length>0){xtimg=new Image();xtimg.src=('https:'==document.location.protocol?'https':'http')+'://app.struq.com/s/s/'+Struq_Token+'/?v=2&rnd='+xt_rd(9)+'&sl_oid='+xt_orderid+'&sl_dis='+(Math.round(sl_dis*100)/100)+'&sl_tot='+(Math.round(sl_tot*100)/100);xtimg.onload=function(){xtimg.onload=null}}if(AreyounetConfig.active){xtporder=xtpcart;xtpcart=undefined}}else if(mtAdvertiserToken.length>0){MyTrack['1013'].Active='1';MyTrack['1013'].Products=ProductsCart}}str=xt44;pdtab=null;var ProductsView=[];try{pdtab=(str.replace(/(\[[^\]]*\])|(;[^|]+)|(&pdtl=)/g,'')).match(/[^|]+/g)}catch(e){}if(pdtab){xtpview=new Array();xtl=(pdtab.length>3)?3:pdtab.length;for(var i=0;i<pdtab.length;i++){pdtab[i]+=' ';var pdtid=pdtab[i].split(/[(::)=]+/g),xtcrit=pdtid[pdtid.length-1];if(xtcrit!=' '){xtpview.push(xtcrit);}if(i<xtl){xtpdtv+='&i'+((xtl!=1)?(i+1):'')+'='+xtcrit}var cat=pdtid;cat.pop();var name=null;var nexpr=xtcrit+'\\[[^\\]]*\\]',xtregn=new RegExp(nexpr,'gi');try{name=str.match(xtregn)[0]}catch(e){}name=name?(String(name).split(xtcrit)[1]).substring(1,(String(name).split(xtcrit)[1]).length-1):'';ProductsView.push({ProductId:xtcrit,Category:(cat[0]||''),SubCategory1:(cat[1]||''),SubCategory2:(cat[2]||''),SubCategory3:(cat[3]||''),SubCategory4:(cat[4]||''),ProductName:name});if(Struq_Token.length>0){xtimg=new Image();xtimg.src=('https:'==document.location.protocol?'https':'http')+'://app.struq.com/s/s/'+Struq_Token+'/?v=2&rnd='+xt_rd(9)+'&sl_ctx=detail&sl_pid='+xtcrit;xtimg.onload=function(){xtimg.onload=null}}}}if(pdtab){if(partnerID>-1){xtimg=new Image();xtimg.src='https://'+partnerName+'.widget.criteo.com/'+partnerPool+'/display.js?p1='+escape('v=2&wi='+widgetIDs[0]+'&pt1='+((xtl!=1)?'3':'2')+xtpdtv)+'&t1=sendEvent&resptype=gif&cb='+xt_rd(11);xtimg.onload=function(){if(xtdis){xtimg2=new Image();xtimg2.src='https://dis.criteo.com/dis/dis.aspx?p='+partnerID+'&c=2&cb='+xt_rd(11);xtimg2.onload=function(){xtimg2.onload=null};xtdis=false}}}if((nextPerformance_ID>-1)&&xtpview[0]){var xtim12=new Image();xtim12.src='https://nxtck.com/act.php?zid='+nextPerformance_ID+';pid='+xtpview[0];xtim12.onload=function(){xtim12.onload=null;};}if(mtAdvertiserToken.length>0){MyTrack['1010'].Active='1';MyTrack['1010'].Products=ProductsView;MyTrack['100'].Active='0'}}else if((partnerID>-1)&&First){xtimg=new Image();xtimg.src='https://'+partnerName+'.widget.criteo.com/'+partnerPool+'/display.js?p1='+escape('v=2&wi='+widgetIDs[0]+'&pt1=0&pt2=1')+'&t1=sendEvent&resptype=gif&cb='+xt_rd(11);xtimg.onload=function(){if(xtdis2){xtimg2=new Image();xtimg2.src='https://dis.criteo.com/dis/dis.aspx?p='+partnerID+'&c=2&cb='+xt_rd(11);xtimg2.onload=function(){xtimg2.onload=null};xtdis2=false}}}if(AreyounetConfig.active){collect()}}
var _mt_ready=function(){if((typeof(MyThings)!='undefined')&&(MyTrack!=null)){for(var itm in MyTrack){if(MyTrack[itm].Active=='1'){switch(itm){case'9902':MyThings.Track({EventType:MyThings.Event.Conversion,Action:itm,Products:MyTrack[itm].Products,TransactionReference:MyTrack[itm].TransactionReference,TransactionAmount:MyTrack[itm].TransactionAmount});break;case'1013':for(var j=0;j<MyTrack[itm].Products.length;j++){MyThings.Track({EventType:MyThings.Event.Visit,Action:itm,ProductId:MyTrack[itm].Products[j].ProductId,Price:MyTrack[itm].Products[j].Price,Qty:MyTrack[itm].Products[j].Qty})}break;case'100':case'200':MyThings.Track({EventType:MyThings.Event.Visit,Action:itm});break;case'1010':for(var j=0;j<MyTrack[itm].Products.length;j++){MyThings.Track({EventType:MyThings.Event.Visit,Action:itm,ProductId:MyTrack[itm].Products[j].ProductId,Category:MyTrack[itm].Products[j].Category,SubCategory1:MyTrack[itm].Products[j].SubCategory1,SubCategory2:MyTrack[itm].Products[j].SubCategory2,SubCategory3:MyTrack[itm].Products[j].SubCategory3,SubCategory4:MyTrack[itm].Products[j].SubCategory4,ProductName:MyTrack[itm].Products[j].ProductName})}break;default:break}}}}}
var arnkoc=function(){var xtexp=new Date();if((AreyounetConfig.cookieDuration)&&(AreyounetConfig.cookieDuration>-1)){xtexp.setMinutes(xtexp.getMinutes()+(AreyounetConfig.cookieDuration*24*60))}else{xtexp.setMinutes(xtexp.getMinutes()+30)}wck('arnko','ko',xtexp,'',1)}
var arnpopunder=function(href){w=window.open('','','width=800,height=510,scrollbars=1,resizable=1,toolbar=1,location=1,menubar=1,status=1,directories=0');w.document.write('<script type="text/javascript">');w.document.write('var tmp=setInterval("arnpopSession();",5000);');w.document.write('var arnpopSession=function(){if((!window.opener)||(typeof(window.opener.arnchandler)!="object")){window.focus();window.location.href=\"'+href+'\";window.clearInterval(tmp);}};');w.document.write('</script>');w.document.close();w.blur();window.focus()}
var arnpop=function(cons){var arnko=xtf1('arnko');if(!arnko){var active=(cons.validation&&(typeof(xw[cons.validation])=='function'))?xw[cons.validation].call():true;if(active){if(cons.endOfSession){if((AreyounetConfig.endOfSessionConfirmation=='')||(confirm(AreyounetConfig.endOfSessionConfirmation))){xt_med('C','','Questionnaire_Areyounet&lnk='+xt48+'&vid='+xw[AreyounetConfig.identifier.val],'A');arnpopunder(arnchandler.href);arnkoc()}else{arnquiz(null,false)}}else{if(AreyounetConfig.htmlelement!=''){var div=document.createElement('div');div.innerHTML=AreyounetConfig.htmlelement;document.body.appendChild(div)}else if((document.getElementById(AreyounetConfig.idelement))){document.getElementById(AreyounetConfig.idelement).style.display=''}else if(AreyounetConfig.confirmtext!=''){if(confirm(AreyounetConfig.confirmtext)){arnquiz(null,true)}else{arnquiz(null,false)}}}}}}
var arnquiz=function(obj,ok,opt){if(ok){xt_med('C','','Questionnaire_Areyounet&lnk='+xt48+'&vid='+xw[AreyounetConfig.identifier.val],'A');var xtobj=null;if(obj){if(obj.nodeName!='A'){var xelp=obj.parentNode;while(xelp){if(xelp.nodeName=='A'){xtobj=xelp;break}xelp=xelp.parentNode}}else{xtobj=obj}}if(xtobj){xtobj.target='_blank';xtobj.href=arnchandler.href+(opt?opt:'')}else{xw.open(arnchandler.href+(opt?opt:''),'_blank').focus()}}arnkoc();if(document.getElementById(AreyounetConfig.idelement))document.getElementById(AreyounetConfig.idelement).style.display='none'}
var arnchandler={encrypted:null,decrypted:{cd:[]},tmp:{cd:[]},init:function(){this.encrypted=xtf1('xtarn');this.decrypt()},save:function(){var xtexp=new Date();xtexp.setMinutes(xtexp.getMinutes()+30);wck('xtarn',this.encrypted,xtexp,'',1)},decrypt:function(){if(this.encrypted&&(this.encrypted!='')){var tmp=this.encrypted.split('|');for(var i=0;i<tmp.length;i++){var det=tmp[i].split('$');for(var j=1;j<det.length;j++){var det2=det[j].split('�');if(typeof(this.decrypted.cd[det[0]])=='undefined'){this.decrypted.cd[det[0]]=[]}this.decrypted.cd[det[0]][det2[0]]=Number(det2[1])}}}},crypt:function(){this.encrypted='';for(elem in this.decrypted.cd){this.encrypted+=elem;for(elem2 in this.decrypted.cd[elem]){this.encrypted+='$'+elem2+'�'+Number(this.decrypted.cd[elem][elem2])}this.encrypted+='|'}},addCondMatch:function(cons,cond,tabCond,col,tabCol){if(typeof(this.tmp.cd[col.name])=='undefined'){this.tmp.cd[col.name]=[]}if(typeof(this.tmp.cd[col.name][cond.val])=='undefined'){this.tmp.cd[col.name][cond.val]=cond.pos}if(typeof(this.decrypted.cd[col.name])=='undefined'){this.decrypted.cd[col.name]=[]}if(typeof(this.decrypted.cd[col.name][cond.val])=='undefined'){this.decrypted.cd[col.name][cond.val]=1}else if(this.tmp.cd[col.name][cond.val]==cond.pos){this.decrypted.cd[col.name][cond.val]++}this.crypt();this.checkCondMatch(cons,cond,tabCond,col,tabCol)},checkCondMatch:function(cons,cond,tabCond,col,tabCol){for(var l=0;l<cons.val.length;l++){var nb=0;for(val in this.decrypted.cd[col.name]){if((tabCol[tabCond[cons.val[l]-1].col-1].name==col.name)&&tabCond[cons.val[l]-1].cond.test(val)){nb+=Number(this.decrypted.cd[col.name][val])}}if((nb>=tabCond[cons.val[l]-1].occur)){cons.bool[l]=true}}var consTrigger=true;for(var n=0;n<cons.bool.length;n++){if(!cons.bool[n]){consTrigger=false;break}}if(consTrigger){this.trigger(cons,cond,col)}},hit:false,trigger:function(cons,cond,col){if(!this.hit){this.href=cons.url;for(name in this.decrypted.cd){this.href+='&'+name+'=';for(val in this.decrypted.cd[name]){for(var i=0;i<this.decrypted.cd[name][val];i++){this.href+=val+col.separ}}}this.href+=(AreyounetConfig.conditions[cond.pos-1].val=='xtporder')?'&orderid='+xt_orderid:'';this.href+='&'+AreyounetConfig.identifier.name+'='+xw[AreyounetConfig.identifier.val];this.href+='&SITE='+xtsite+'&VID='+xw[AreyounetConfig.identifier.val];arnpop(cons);this.hit=true}},href:null}
var collect=function(){debugger;var xtarnvdc=xtf1('xtarnvdc');if(!xtarnvdc){xtarnvdc=xt21.getTime()}var xtexp=new Date();xtexp.setMinutes(xtexp.getMinutes()+30);wck('xtarnvdc',xtarnvdc,xtexp,'',1);try{arnchandler.init();var tabConst=AreyounetConfig.constraints.sort(function(a,b){return a.prior-b.prior}),tabCond=AreyounetConfig.conditions.sort(function(a,b){return a.pos-b.pos}),tabCol=AreyounetConfig.collect.sort(function(a,b){return a.col-b.col});for(var i=0;i<tabConst.length;i++){if(typeof(tabConst[i])!='undefined'){var obj={val:tabConst[i].cond.match(/\d+/g),bool:new Array(tabConst[i].cond.match(/\d+/g).length),prior:tabConst[i].prior,url:tabConst[i].url,validation:tabConst[i].validation,endOfSession:tabConst[i].endOfSession};for(var j=0;j<obj.val.length;j++){if(typeof(tabCond[obj.val[j]-1])!='undefined'){switch(typeof(xw[tabCond[obj.val[j]-1].val])){case'string':var objChild={val:'',cond:tabCond[obj.val[j]-1].cond,occur:tabCond[obj.val[j]-1].occur,col:tabCond[obj.val[j]-1].col,pos:tabCond[obj.val[j]-1].pos};if(objChild.cond.test(xw[tabCond[obj.val[j]-1].val])){if(tabCond[obj.val[j]-1].order){var xtarnord=xtf1('xtarnord');xtarnord=(xtarnord?xtarnord+';':'')+xw[tabCond[obj.val[j]-1].val];var tabPages=xtarnord.split(';');var m=0,n=0,limit=tabCond[obj.val[j]-1].order.length;while((m<tabPages.length)&&(n<limit)){var tabPagesCond=tabCond[obj.val[j]-1].order[n];if(tabPagesCond.test(tabPages[m])){objChild.val+=tabPages[m]+';';n++}else if((n>0)&&tabCond[obj.val[j]-1].strict){break}m++}if(n==limit){if(!tabCond[obj.val[j]-1].strict){objChild.val=xtarnord}arnchandler.addCondMatch(obj,objChild,tabCond,tabCol[objChild.col-1],tabCol)}var xtexp=new Date();xtexp.setMinutes(xtexp.getMinutes()+30);wck('xtarnord',xtarnord,xtexp,'',1)}else{objChild.val=xw[tabCond[obj.val[j]-1].val];arnchandler.addCondMatch(obj,objChild,tabCond,tabCol[objChild.col-1],tabCol)}arnchandler.save()}break;case'object':for(var k=0;k<xw[tabCond[obj.val[j]-1].val].length;k++){var objChild={val:xw[tabCond[obj.val[j]-1].val][k],cond:tabCond[obj.val[j]-1].cond,occur:tabCond[obj.val[j]-1].occur,col:tabCond[obj.val[j]-1].col,pos:tabCond[obj.val[j]-1].pos};if(objChild.cond.test(objChild.val)){arnchandler.addCondMatch(obj,objChild,tabCond,tabCol[objChild.col-1],tabCol)}}arnchandler.save();break;default:if(tabCond[obj.val[j]-1].val){switch(tabCond[obj.val[j]-1].val){case'pagePattern':var objChild={val:xw['xtpage']+';'+tabCond[obj.val[j]-1].duration,cond:tabCond[obj.val[j]-1].cond,duration:tabCond[obj.val[j]-1].duration,occur:tabCond[obj.val[j]-1].occur,col:tabCond[obj.val[j]-1].col,pos:tabCond[obj.val[j]-1].pos};if(objChild.cond.test(objChild.val)){setTimeout(function(){arnchandler.addCondMatch(obj,objChild,tabCond,tabCol[objChild.col-1],tabCol);arnchandler.save()},objChild.duration*1000)}break;case'VisitDuration':var objChild={val:tabCond[obj.val[j]-1].duration,cond:tabCond[obj.val[j]-1].cond,duration:tabCond[obj.val[j]-1].duration,occur:tabCond[obj.val[j]-1].occur,col:tabCond[obj.val[j]-1].col,pos:tabCond[obj.val[j]-1].pos};var xtarnvd=xt21.getTime();if(Math.abs(xtarnvd-xtarnvdc)>=objChild.duration){arnchandler.addCondMatch(obj,objChild,tabCond,tabCol[objChild.col-1],tabCol);arnchandler.save()}break;default:break}}break}}}}}}catch(e){}}
xtPart();