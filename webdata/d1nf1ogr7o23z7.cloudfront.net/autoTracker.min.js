/* SPT */!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AutoTrack=e():t.AutoTrack=e()}(this,function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var i={},n=r(1),o=r(2),s={};try{s=r(!function(){var t=new Error('Cannot find module "../lib/vars"');throw t.code="MODULE_NOT_FOUND",t}())}catch(a){s=r(6)}"undefined"!=typeof pulse2opt?i=pulse2opt:"undefined"!=typeof _opt&&(i=_opt);try{var c=i.cookieSyncUrl||s.envVars.cookieSyncUrl;o.initTracking(i),c&&n.initCookieSync({url:c,userId:i.userId})}catch(a){}t.exports=o},function(t,e){"use strict";function r(t){var e=new Image,r=t.url+"?r="+Math.random();t.userId&&(r+="&id="+t.userId),e.src=r}t.exports.initCookieSync=r},function(t,e,r){"use strict";function i(t){var e=t.throttle||1;if(Math.random()<e){var i=r(3);return o=new i(t),"complete"===document.readyState?n(t.trackingFeatures):window.addEventListener("load",function(){n(t.trackingFeatures)},!1),o.getPageViewId()}}function n(t){t=t||{};var e=r(13);t.pageLoad!==!1&&e.pageLoad(o),t.hashChange===!0&&e.hashChange(o),t.pageUnload===!0&&e.pageUnload(o);var i=r(14);t.clickButton===!0&&i.button(o),t.clickSubmit===!0&&i.submit(o);var n=r(15);t.relativeScroll===!0&&n.trackScrollRelative(o,25),t.itemVisible===!0&&n.trackScrollItems(o);var s=r(16);t.facebook===!0&&(s.trackFacebookLikes(o),s.trackFacebookUnlikes(o),s.trackFacebookShares(o)),t.twitter===!0&&s.trackTwitterShares(o)}var o={};t.exports.initTracking=function(t){i(t)},t.exports.getPageViewId=function(){return o.getPageViewId()},t.exports.logoutEvent=function(){o.userLogout()},t.exports.loginEvent=function(t){o.userLogin(t)},t.exports.activity=function(){return o}},function(t,e,r){"use strict";function i(t){if(this.pulse2timing={init:Date.now()},!t.clientId)throw new Error("clientId is required");this.vars=o,this.version=p,this.clientId=("urn:schibsted.com:"+t.clientId).toLowerCase(),t.url?this.url=t.url+"/"+this.clientId:this.url=this.vars.envVars.dataCollectorUrl+"/"+this.clientId,t.transport?this.transport=t.transport:this.transport=u,t.respectDoNotTrack===!0&&1===navigator.doNotTrack?this.allowTracking=!1:this.allowTracking=!0,this.opts=t,this.pageViewId=c.getUuidV4(),this.contentId=t.contentId||t.pageId||document.location,this.contentType=t.contentType||t.pageType||"Content",this.provider=t.provider||{},this.objectMeta=t.object||{},this.userIdDomain=t.userIdDomain||"schibsted.com",this.noRedirect=!0,this.utils=c,this.queue=[],this.events=new a(this),this.user=new d({userId:this.opts.userId,userServiceUrl:this.opts.userServiceUrl,noRedirect:this.noRedirect,transport:this.transport,utils:this.utils}),this.initIds(function(){})}var n=r(4)("spt:pulse"),o={};try{o=r(5)}catch(s){o=r(6)}var a=r(7),c=r(9),d=r(11),u=r(10),p=r(12).version;i.prototype.initIds=function(t){t=t||function(){};var e=this;n("Fetching Ids"),this.pulse2timing.fetchIds=Date.now(),this.user.getUserId(function(r,i){return r?(n("Failed to fetch ids from CIS",r),delete e.envId):(e.userId||(e.userId=i.userId),e.envId=i.envId),e.pulse2timing.receivedIds=Date.now(),e.waitingToTransmitQueue===!0&&(e.sendQueue(),e.waitingToTransmitQueue=!1),t(i)})},i.prototype.addToQueue=function(t){this.queue.push(t)},i.prototype.sendQueue=function(t){if(t=t||function(){},!this.queue.length)return t();if(!this.allowTracking)return t();if("undefined"==typeof this.envId)return this.waitingToTransmitQueue=!0,t();n("Sending queue");for(var e=this.queue.slice(0),r=0;r<e.length;r++)this.enrichEvents(e[r]);this.queue=[];var i=this;this.transport(this.url,e,function(r){r?(n("Failed to send queue"),i.queue=i.queue.concat(e),t(r)):t()})},i.prototype.send=function(t,e){if(e||(e=function(){}),!this.allowTracking)return e();if("undefined"==typeof this.envId)return this.addToQueue(t),this.waitingToTransmitQueue=!0,e();n("Sending object");var r=this;this.enrichEvents(t),this.transport(this.url,[t],function(i){i?(n("Failed to send object"),r.addToQueue(t),e(i)):e()})},i.prototype.enrichEvents=function(t){this.addObjectCustom(t),this.addUserId(t),t.application.performance&&(t.application.performance.pulse2.sendEvents=Date.now())},i.prototype.addUserId=function(t){var e=this.user.getTheEnvironmentId(),r=this.user.getTheUserId();t.actor&&e&&"undefined"!==e&&(0!==String(e).indexOf("urn:")?(t.actor["@id"]="urn:schibsted.com:environment:"+e,t.actor["spt:environmentId"]="urn:schibsted.com:environment:"+e):(t.actor["@id"]=e,t.actor["spt:environmentId"]=e),r&&-1===String(r).indexOf("undefined")&&(0!==String(r).indexOf("urn:")?t.actor["spt:userId"]="urn:"+this.userIdDomain+":user:"+r:t.actor["spt:userId"]=r))},i.prototype.addObjectCustom=function(t){if(this.objectMeta){t.object||(t.object={}),t.object["spt:custom"]||(t.object["spt:custom"]={});for(var e in this.objectMeta)this.objectMeta.hasOwnProperty(e)&&(t.object["spt:custom"][e]=this.objectMeta[e])}},i.prototype.createActor=function(){var t={};return t["@type"]="Person",t["spt:userAgent"]=navigator.userAgent,t["spt:screenSize"]=window.screen.width+"x"+window.screen.height,t["spt:viewportSize"]=c.getViewportDimensions(),t["spt:acceptLanguage"]=c.getDeviceLanguage(),t},i.prototype.createReducedActor=function(){var t={};return t["@type"]="Person",t},i.prototype.createProvider=function(){var t={};t["@type"]="Organization",t["@id"]=this.clientId,t.url=document.URL;for(var e in this.provider)this.provider.hasOwnProperty(e)&&(t[e]=this.provider[e]);return t},i.prototype.createScaffold=function(t){var e={};return e.application={"spt:sdkType":"JS","spt:sdkVersion":this.version},t&&window.performance&&(e.application.performance={browser:window.performance.timing,pulse2:this.pulse2timing}),e["@context"]="https://schema.schibsted.com/ns/events/0.1#",e["@id"]=c.getUuidV4(),e["spt:pageViewId"]=this.pageViewId,e.published=c.getTimestamp(),t?e.actor=this.createActor():e.actor=this.createReducedActor(),e.provider=this.createProvider(),e},i.prototype.getPageViewId=function(){return this.pageViewId},i.prototype.getSessionId=function(){console.log("Deprecated: getSessionId")},i.prototype.userLogout=function(){delete this.user.idObj.userId,this.refreshUserIds()},i.prototype.userLogin=function(t){this.user.idObj.userId=t,this.refreshUserIds()},i.prototype.refreshUserIds=function(){this.waitingToTransmitQueue=!0,this.initIds()},t.exports=i},function(t,e){"use strict";t.exports=function(){return function(){}}},function(t,e){t.exports.envVars={dataCollectorUrl:"https://collector.schibsted.io/api/v1/track",userServiceUrl:"https://cis.schibsted.com/api/v1/identify",errorReportingUrl:""}},function(t,e){t.exports.envVars={dataCollectorUrl:"https://127.0.0.1:8002/api/v1/track",userServiceUrl:"https://cis.schibsted.com/api/v1/identify",errorReportingUrl:""}},function(t,e,r){"use strict";function i(t){if(!t)throw new Error("activity required");this.activity=t,this.contentId=t.contentId,this.contentType=t.contentType}var n=r(8);i.prototype.trackContentView=function(t){var e=this.activity.createScaffold(!0);return e["@type"]="View",e.object=this.addPageStandards(),e.object.displayName=t||document.title,document.referrer&&(e.origin={url:document.referrer}),new n(this.activity,e,["object","origin"])},i.prototype.trackPageLoad=function(t,e){return e=e,this.trackContentView(t)},i.prototype.trackForm=function(t,e,r){var i=this.activity.createScaffold();return i["@type"]=r||"Post",i.object={"@id":this.getUrnIdWithContentType()+":form:"+t},i.origin=this.addPageStandards(),i.result={"@type":e,"@id":this.getUrnIdWithContentType()+":form:"+t},new n(this.activity,i,["object","result","origin"])},i.prototype.trackComment=function(t,e){return this.trackForm(t,"Note",e)},i.prototype.trackPoll=function(t,e){return this.trackForm(t,"Question",e)},i.prototype.trackClick=function(t,e,r,i,o){var s=this.activity.createScaffold();return s["@type"]=o||"Accept",s.object={"@id":this.getUrnIdWithContentType(i,r)+":element:"+t,"@type":"Link",displayName:e},s.target={"@id":this.getUrnIdWithContentType(i,r),"@type":r},new n(this.activity,s,["object","target"])},i.prototype.trackSocial=function(t,e,r){var i=this.activity.createScaffold();return i["@type"]=r||"Like",i.object=this.addPageStandards(),i.origin={"@id":this.getUrnIdWithContentType()+":element:"+t,"@type":"Link"},i.target={"@id":"urn:"+e.toLowerCase()+":action:"+i["@type"].toLowerCase(),"@type":"Service"},new n(this.activity,i,["object","origin","target"])},i.prototype.trackMediaState=function(t,e,r){var i=this.activity.createScaffold();return i["@type"]=r||"Watch",i.object={"@type":e,"@id":this.getUrnIdWithContentType()+":"+e+":"+t},i.origin=this.addPageStandards(),new n(this.activity,i,["object","origin"])},i.prototype.trackScroll=function(t,e){var r=this.activity.createScaffold();return r["@type"]=e||"Arrive",r.object=this.addPageStandards(),r.result={"@type":"Place","@id":this.getUrnIdWithContentType()+":scroll:"+t,"spt:depth":t},new n(this.activity,r,["object","result"])},i.prototype.trackVisibility=function(t,e,r){if("undefined"==typeof e)throw new Error("No time parameter was passed to this function");var i=this.activity.createScaffold();return i["@type"]=r||"View",i.origin=this.addPageStandards(),i.object={"@type":"Content","@id":this.getUrnIdWithContentType()+":element:"+t},e.start?i.object.startTime=e.start:e&&!e.end&&(i.object.startTime=e),e.end&&(i.object.endTime=e.end),new n(this.activity,i,["origin","object"])},i.prototype.trackExit=function(t,e,r){var i=this.activity.createScaffold();return i["@type"]=r||"Leave",i.object=this.addPageStandards(),i.target={},"undefined"!=typeof t&&"undefined"!=typeof e&&(i.target={"@type":e,"@id":this.getUrnIdWithContentType(t,e)}),new n(this.activity,i,["object","target"])},i.prototype.trackEngagementTime=function(t,e){var r=this.activity.createScaffold();return r["@type"]=e||"View",r.object=this.addPageStandards(),r.duration=t,new n(this.activity,r,["object"])},i.prototype.trackCustomEvent=function(t,e){var r=this.activity.createScaffold(),i=[];if(!e||!t)throw new Error("activityType and obj is required");r["@type"]=e;for(var o in t)r[o]=t[o],i.push(o);return new n(this.activity,r,i)},i.prototype.addPageStandards=function(){var t={};return t["@type"]=this.activity.contentType,String(this.activity.contentId).indexOf("urn:")>-1?t["@id"]=this.activity.contentId:t["@id"]=this.getUrnIdWithContentType(this.activity.contentId),t.url=document.URL,t.displayName=document.title,this.addCategoryToEvents(t)},i.prototype.addCategoryToEvents=function(t){var e=this.activity.opts,r="";return e.provider=e.provider||{},e.object=e.object||{},e.category?r=e.category:e.object.category?r=e.object.category:e.provider.category&&(r=e.provider.category),Array.isArray(r)&&(r=r.toString()),r&&(t.category=r),t},i.prototype.getUrnIdWithContentType=function(t,e){var r=t||this.activity.contentId;if(-1===String(r).indexOf("urn:")){var i=e||this.activity.contentType,n=this.getDomainFromUrl(document.URL);return"urn:"+n+":"+i.toLowerCase()+":"+r}return r},i.prototype.getDomainFromUrl=function(t){var e=t.match(/^https?\:\/\/(www.)?([^\/:?#]+)(?:[\/:?#]|$)/i);return e&&e[2]},t.exports=i},function(t,e){"use strict";function r(t,e,r){if(!t)throw new Error("activity required");if(!e)throw new Error("data required");this.activity=t,this.data=e,this.objectOrder=r||[]}r.prototype.queue=function(){this.activity.addToQueue(this.data)},r.prototype.send=function(t){this.activity.send(this.data,t)},r.prototype.addProperty=function(t,e,r){var i=this.getObjectKey(t);return this.data[i][e]=r,this},r.prototype.addCustomData=function(t,e){var r=this.getObjectKey(t);return this.data[r]["spt:custom"]=e,this},r.prototype.getObjectKey=function(t){if("primary"===t)return this.objectOrder[0];if("secondary"===t)return this.objectOrder[1];if("tertiary"===t)return this.objectOrder[2];throw new Error("Object reference not valid")},t.exports=r},function(t,e,r){"use strict";var i={};try{i=r(5)}catch(n){i=r(6)}var o=r(10);t.exports.retry=function(t,e,r){if(!t||"number"!=typeof t)throw new Error("times required");if(!e||"function"!=typeof e)throw new Error("task required");if(!r||"function"!=typeof r)throw new Error("callback required");var i=1,n=function(){arguments[0]&&i>=t?r.apply(null,arguments):arguments[0]?(i+=1,e(n)):r.apply(null,arguments)};e(n)},t.exports.getViewportDimensions=function(){var t,e;return"undefined"!=typeof window.innerWidth?(t=window.innerWidth,e=window.innerHeight):"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=document.getElementsByTagName("body")[0].clientWidth,e=document.getElementsByTagName("body")[0].clientHeight),t+"x"+e},t.exports.getDeviceLanguage=function(){var t;return navigator.userLanguage?t=navigator.userLanguage:navigator.language&&(t=navigator.language),t},t.exports.getTimestamp=function(){var t=new Date,e=-t.getTimezoneOffset(),r=e>=0?"+":"-",i=function(t){var e=Math.abs(Math.floor(t));return(10>e?"0":"")+e},n=t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate());return n=n+"T"+i(t.getHours())+":"+i(t.getMinutes()),n=n+":"+i(t.getSeconds()),n=n+r+i(e/60)+":"+i(e%60)},t.exports.getUuidV4=function(){for(var t="",e=0;36>e;e++){var r=null;r=14===e?4:19===e?Math.floor(4*Math.random()+8).toString(16):8===e||13===e||18===e||23===e?"-":Math.floor(16*Math.random()).toString(16),t+=r}return t},t.exports.sendErrorReport=function(t){var e={errorCode:"GENERAL_ACTIVITY_ERROR",errorMessage:"Something went wrong",sdkType:"JS",sdkVersion:i.envVars.sdkVersion,options:{clientId:"abc",dataCollectorUrl:i.envVars.dataCollectorUrl,anonymousIdentityUrl:i.envVars.userServiceUrl,errorReportingUrl:i.envVars.errorReportingUrl,retries:t}};o(i.envVars.errorReportingUrl,e)},t.exports.getQueryVariable=function(t){for(var e=window.location.search.substring(1),r=e.split("&"),i=0;i<r.length;i++){var n=r[i].split("=");if(n[0]===t)return n[1]}for(r=e.split("&amp"),i=0;i<r.length;i++){var o=r[i].split("=");if(o[0]===t)return o[1]}return void 0}},function(t,e,r){"use strict";function i(t,e,r,i){if(!r)throw new Error("callback required");return t?e&&"object"==typeof e?(i=i||!1,void s.retry(3,function(r){var o=n(i,"POST",t);o||r("Failed to identify request method"),"undefined"!=typeof XDomainRequest?(o.onload=function(){r(null,o)},o.onprogress=function(){},o.onerror=function(){r("Failed request"),o.abort()},o.ontimeout=o.onerror):o.onreadystatechange=function(){4===this.readyState&&(200===this.status?r(null,o):r("Failed with status "+this.status))};try{o.send(JSON.stringify(e))}catch(s){r(s.name+": "+s.message)}},r)):r("data required"):r("url required")}function n(t,e,r){if("undefined"!=typeof XDomainRequest){var i=new XDomainRequest;return i.open(e.toLowerCase(),o(r)),i}var n=new XMLHttpRequest;return"withCredentials"in n?(n.open(e,r),n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),t&&(n.withCredentials=!0),n):!1}function o(t){var e=t.split("://");return"//"+e.pop()}var s=r(9);t.exports=i},function(t,e,r){"use strict";function i(t){t=t||{},this.idObj={},this.cookieKey="_pulse2data",this.cookiesAllowed=navigator.cookieEnabled,this.anonIdPlaceholder="x",this.opts=t,this.visitorIdPlaceholder="v",this.redirectString="https://cis.schibsted.com/redirect/?redirectUrl="+document.location,this.userServiceUrl=t.userServiceUrl||s.envVars.userServiceUrl,this.transport=t.transport||n,this.utils=t.utils||o,this.noRedirect=void 0!==t.noRedirect?t.noRedirect:!0}var n=r(10),o=r(9),s={};try{s=r(5)}catch(a){s=r(6)}i.prototype.getUserId=function(t){t=t||function(){};var e=this.getIdsFromCookie();return this.opts.userId&&(e.userId=this.opts.userId),this.mapUserData(e),this.idObj.envId&&!this.userStatusHasChanged()?t(null,this.idObj):void this.getIdsFromService(this.idObj,function(e,r){return this.onIdServiceResponse(e,r,t)}.bind(this))},i.prototype.mapUserData=function(t){this.idObj.userId=t.userId||this.idObj.userId,this.idObj.envId=t.environmentId,this.idObj.prevUserId=t.prevUserId,this.setIdsInCookie()},i.prototype.setIdsInCookie=function(){if(this.idObj.envId){var t=new Date,e=t.getTime();t.setTime(e+9e5);var r=[this.idObj.envId,this.visitorIdPlaceholder,this.idObj.userId||this.anonIdPlaceholder];document.cookie=this.cookieKey+"="+r+";expires="+t.toUTCString()}},i.prototype.getIdsFromCookie=function(){var t=this.getCookie(this.cookieKey);if(!t||-1!==t.indexOf("undefined"))return this.deleteCookie(this.cookieKey),{};var e=t.split(",");if(e.length<2)return this.deleteCookie(this.cookieKey),{};var r={environmentId:e[0],prevUserId:e[2]};return r},i.prototype.getCookie=function(t){var e=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||void 0;return e},i.prototype.deleteCookie=function(t){document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT"},i.prototype.getIdsFromService=function(t,e){var r=this.userServiceUrl;this.transport(r,t,function(t,r){if(t)return e(t);var i=JSON.parse(r.response||r.responseText);this.mapUserData(i.data),e(null,i.data)}.bind(this),!0)},i.prototype.onIdServiceResponse=function(t,e,r){return t&&r(t),this.utils.getQueryVariable("failedToSetCookie")?r(null,this.idObj):e.cisCookieSet||!this.cookiesAllowed?r(null,this.idObj):this.confirmIdServiceCookie(r)},i.prototype.confirmIdServiceCookie=function(t){this.getIdsFromService(this.idObj,function(e,r){return e?t(e):(this.resolveRedirect(r),void t(null,this.idObj))}.bind(this))},i.prototype.resolveRedirect=function(t){t.cisCookieSet||this.noRedirect||this.doRedirect(this.redirectString)},i.prototype.doRedirect=function(t){this.noRedirect||(window.location.href=t)},i.prototype.userStatusHasChanged=function(){var t=this.idObj.userId,e=this.idObj.prevUserId;return e?t&&e!==t.toString()||!t&&e!==this.anonIdPlaceholder:!1},i.prototype.getTheUserId=function(){return this.idObj.userId},i.prototype.getTheEnvironmentId=function(){return this.idObj.envId},t.exports=i},function(t,e){t.exports={name:"schibsted-event-tracking",version:"0.8.2",main:"lib/activity.js",repository:{type:"git",url:"git@github.com:schibsted/sdk-js-event-tracking.git"},bugs:{url:"https://github.com/schibsted/sdk-js-event-tracking/issues"},dependencies:{webpack:"^1.5.3",debug:"^2.1.1"},devDependencies:{chai:"^2.0.0","concat-files":"^0.1.0",extend:"^3.0.0",fs:"0.0.2",grunt:"~0.4.1","grunt-contrib-jshint":"^0.11.0","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-watch":"^0.6.1","grunt-http-server":"^1.3.0","grunt-jscs":"^1.5.0","grunt-karma":"^0.12.0","grunt-nightwatch":"^0.4.6","grunt-shell":"^1.1.1","grunt-webpack":"^1.0.8","istanbul-instrumenter-loader":"^0.1.2",jscs:"^1.11.3",jshint:"^2.6.0","json-loader":"^0.5.2","karma-browserstack-launcher":"^0.1.2","karma-chrome-launcher":"^0.1.7","karma-coverage":"^0.2.7","karma-mocha":"^0.1.10","karma-phantomjs-launcher":"^0.1.4","karma-sinon-chai":"^0.3.0","karma-webpack":"^1.5.0",mkdirp:"^0.5.1",mocha:"^2.1.0",nightwatch:"^0.6.5",phantomjs:"1.9.13","phantomjs-polyfill":"0.0.1",sinon:"^1.12.2","type-of-is":"^3.4.0","webpack-dev-server":"^1.7.0"},engines:{node:"0.12.x"},scripts:{test:"jshint . && jscs . && ./node_modules/karma/bin/karma start karma.conf1.js --single-run && grunt integration",lint:"jshint . && jscs .",build:"node buildscript/buildFiles.js --build"}}},function(t,e){"use strict";var r=function(t){for(var e,r,i,n,o,s={meta:{},og:{}},a=0;a<t.length;a++){e=t[a],r=e.getAttribute("name"),i=e.getAttribute("content"),n=e.getAttribute("property"),o=n&&n.indexOf("og:")>-1;try{r&&i?s.meta["spt:"+r]=decodeURI(i):o&&(s.og["spt:"+n]=decodeURI(i))}catch(c){}}return s};t.exports.pageLoad=function(t){var e=t.events.trackPageLoad(),i=document.querySelectorAll("meta"),n=r(i);n.meta&&e.addProperty("primary","spt:meta",n.meta),n.og&&e.addProperty("primary","spt:og",n.og),e.send()},t.exports.hashChange=function(t){document.addEventListener("hashchange",function(){t.events.trackPageLoad().send()},!1)},t.exports.pageUnload=function(t){var e=Date.now(),r=!1;document.addEventListener("click",function(i){if(!r){r=!0;var n=i.target;if("a"===n.tagName.toLowerCase()){var o=n.getAttribute("href"),s=/^https?:\/\//i;if(null!==o.match(s)){t.events.trackEngagementTime(Date.now()-e).queue();var a=t.events.trackExit("urn:exit:"+o,"Page");a.addProperty("secondary","url",o),a.queue(),t.sendQueue()}}}},!1),window.addEventListener("beforeunload",function(){r||(r=!0,t.events.trackEngagementTime(Date.now()-e).queue(),t.events.trackExit().queue(),t.sendQueue())}),window.addEventListener("unload",function(){r||(r=!0,t.events.trackEngagementTime(Date.now()-e).queue(),t.events.trackExit().queue(),t.sendQueue())},!1)}},function(t,e){"use strict";var r=["track-comment","track-poll","track-form"];t.exports.button=function(t){document.addEventListener("click",function(e){var r=e.target||e.srcElement;/.*track-click.*/.test(r.className)&&t.events.trackClick(r.id).send()},!1)},t.exports.submit=function(t){document.addEventListener("submit",function(e){var i,n=e.target||e.srcElement;if(n&&n.id)switch(i=r.filter(function(t){return n.className.indexOf(t)>-1})[0]){case"track-poll":t.events.trackPoll(n.id,"Post").send();break;case"track-comment":t.events.trackComment(n.id,"Post").send();break;default:t.events.trackForm(n.id,"Note","Post").send()}},!1)}},function(t,e){"use strict";t.exports.trackScrollRelative=function(t,e){var r=0;document.addEventListener("scroll",function(){var i=document.getElementsByTagName("body")[0],n=i.scrollTop/(i.offsetHeight-window.innerHeight)*100;n-r>1.5*e&&(r=Math.floor(n/e)*e),n>=r+e?(r+=e,t.events.trackScroll(r,"Arrive").send(),r>100&&(r=100)):r-e>=n&&(r-=e,t.events.trackScroll(r,"Arrive").send(),r>100&&(r=100))},!1)},t.exports.trackScrollItems=function(t){function e(t){for(var e=t.offsetTop,r=t.offsetLeft,i=t.offsetWidth,n=t.offsetHeight;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,r+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&r<window.pageXOffset+window.innerWidth&&e+n>window.pageYOffset&&r+i>window.pageXOffset}var r,i=[],n=document.getElementsByTagName("*");for(r=0;r<n.length;r++)(" "+n[r].className+" ").indexOf(" track-visibility ")>-1&&i.push({element:n[r],visible:!1});document.addEventListener("scroll",function(){for(r=0;r<i.length;r++){var n=i[r];if(e(n.element)!==n.visible)if(n.visible===!1)n.visible=!0,n.timeStart=t.utils.getTimestamp(),t.events.trackVisibility(n.element.id,n.timeStart).send();else if(n.visible===!0){n.visible=!1;var o={start:n.timeStart,end:t.utils.getTimestamp()};t.events.trackVisibility(n.element.id,o).send(),n.timeStart=null}}},!1)}},function(t,e){"use strict";t.exports.trackFacebookLikes=function(t){FB.Event.subscribe("edge.create",function(e){var r=t.events.trackSocial("facebook-like","Facebook","Like");r.addProperty("tertiary","url",e),r.send()})},t.exports.trackFacebookUnlikes=function(t){FB.Event.subscribe("edge.remove",function(e){var r=t.events.trackSocial("facebook-unlike","Facebook","Remove");r.addProperty("tertiary","url",e),r.send()})},t.exports.trackFacebookShares=function(t){FB.Event.subscribe("message.send",function(e){var r=t.events.trackSocial("facebook-share","Facebook","Share");r.addProperty("tertiary","url",e),r.send()})},t.exports.trackTwitterShares=function(t){function e(){t.events.trackSocial("twitter-share","Twitter","Share").send()}try{twttr.ready(function(){if(void 0===typeof twttr)throw"twitter is not included in the site";twttr.events.bind("tweet",e)})}catch(r){}}}])});var pulse2config = {
    "client": "",
    "config": [
        {
            "throttle": 1,
			"dataCollector": "https://collector.schibsted.io/api/v1/track",
            "cis": "https://cis.schibsted.com/api/v1/identify"
        }
    ]
}
;