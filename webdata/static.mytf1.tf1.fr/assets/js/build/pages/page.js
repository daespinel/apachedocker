define(["lib/utils","lib/throttle","lib/moment","blocks/commons/favorite","lib/picturefill","lib/mprogress"],function(e,t,n,i,o,s){"use strict";function a(){return this.addIframeListen(),window.addEventListener("resize",Cowboy.throttle(200,function(){this.recalculateHeight(document.body)}.bind(this))),this}window.utils=new e,window.picturefill=o,"placeholder"in document.createElement("input")||require(["lib/placeholderAttributePolyfill"],function(e){}),window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||require(["lib/requestAnimationFramePolyfill"],function(e){}),class_userlib.isSupportedBrowser()||require(["lib/bannerModernBrowser"],function(e){window.banner=new e}),require(["lib/hawkeye"],function(e){window.oas_script=new e}),require(["lib/xiti"],function(e){window.xiti_script=new e});var r=new s,l=(new i(document.body),window.utils.parseUri(window.location).host);document.domain="tf1.fr",window.moment=n,n.locale("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv_févr_mars_avr_mai_juin_juil_août_sept_oct_nov_déc".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim_lun_mar_mer_jeu_ven_sam".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [à] LT",LLLL:"dddd D MMMM YYYY [à] LT"},calendar:{sameDay:"[aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"[le] DD/MM/YYYY à hh:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinal:function(e){return e+(1===e?"er":"ème")},week:{dow:1,doy:4}});var d=Math.floor(1e3*Math.random());10>d&&require(["lib/performance"],function(e){var e=new e({urlTracking:"/tracking"},{page:document.body.getAttribute("data-page")});e.run()});var c=class_userlib.getDevice().type||"desktop";if("desktop"===c){var u=Math.floor(1e4*Math.random());100>u&&!function(e,t,n,i,o){function s(){var e=t.createElement("script");e.async=!0,e.src="//radar.cedexis.com/1/12182/radar.js",t.body.appendChild(e)}/\bMSIE 6/i.test(e.navigator.userAgent)||(e[n]?e[n](o,s,!1):e[i]&&e[i]("on"+o,s))}(window,document,"addEventListener","attachEvent","load")}var m=function(){var e="";return class_userlib&&(e=class_userlib.getBrowser()),"IE"===e.name&&9===e.major?!1:"IE"===e.name&&10===e.major?navigator.msMaxTouchPoints>0:"IE"===e.name&&e.major>10||navigator.maxTouchPoints?navigator.maxTouchPoints>0:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||!1};window.isTouch=m();var w=function(){if(!class_userlib.getCookie("cookieLegacy")){var e=document.createElement("div"),t=document.createElement("span");isTouch&&require(["lib/hammer"],function(t){var n=new t.Manager(e);n.on("tap",function(t){t.preventDefault(),class_userlib.setCookie("cookieLegacy",!0,31556926,"/",document.location.host),e.parentNode.removeChild(e)})}),t.addEventListener("click",function(t){class_userlib.setCookie("cookieLegacy",!0,31556926,"/",document.location.host),e.parentNode.removeChild(e)}),e.innerHTML="<p>En poursuivant votre navigation, vous acceptez l'utilisation de cookies à des fins statistiques et de personnalisation. <a href='"+useful_urls.politique_cookies+"'>En savoir plus</a></p>",e.appendChild(t),t.innerHTML="x",window.utils.addClass(e,"banner_cookies"),document.body.appendChild(e)}};w(),window.onpopstate=function(e){var t="";e&&(class_userlib&&(v=class_userlib.getOS(),t=class_userlib.getBrowser()),"iOS"===v.name||"Safari"===t.name)};var _=function(e,t){var n=window.utils.parseUri(e),s="/ajax"+n.relative,a=new XMLHttpRequest;r.set(0),r.start(),a.addEventListener("progress",y,!1),a.open("GET",s,!0),a.onreadystatechange=function(){try{if(4===a.readyState){r.end(),setTimeout(function(){window.scrollTo(0,0)},0);var n=JSON.parse(a.responseText);if(document.getElementById("wrapper").innerHTML=n.html,500===n.statusCode)return void(window.location=e);n.seo&&n.seo.title&&(document.title=n.seo.title),history.pushState&&history.pushState({},document.title,e),window.utils.parseScript(document.getElementById("wrapper").innerHTML);var s=document.getElementById("TF1__header");s.outerHTML=n.header,class_page.addJavascriptHeader(!0);var l=document.getElementById("TF1__menu");l.outerHTML=n.menu,class_page.addJavascriptMenu(!0),n.skin&&(document.body.className="mini-player "+n.skin),"function"==typeof o&&o({reevaluate:!0}),t&&(window.js_blocks["blocks_sections_content-video"]&&(window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements(),window.js_blocks["blocks_sections_content-video"].addEventScroll(),window.js_blocks["blocks_sections_content-video"].desactivateMini()),window.js_blocks["blocks_sections_channel-live"]&&(window.js_blocks["blocks_sections_channel-live"].addEventScroll(),window.js_blocks["blocks_sections_channel-live"].desactivateMini()));new i(document.body);_gaq&&_gaq.push(["_trackPageview"])}}catch(d){window.location=e}},a.send()},y=function(e){if(e.lengthComputable){var t=e.loaded/e.total;r.set(t)}};if(class_userlib){var v=class_userlib.getOS().name,h=new RegExp(" ","g"),f=v.replace(h,"-").toLowerCase();window.utils.addClass(document.body,f)}return a.prototype={ajaxLoad:function(e){_(e,!0)},addCheckLazy:function(){window.addEventListener("scroll",Cowboy.throttle(200,this.lazyloadExtern.bind(this)))},addFavoriteManager:function(e){new i(e)},addLinksEvents:function(e){var t=e.querySelectorAll(".sticky_ads"),n=t.length;n>0&&require(["lib/sticky"],function(e){window.Stickyfill=e;for(var i=n-1;i>=0;i--)window.Stickyfill.add(t[i])});for(var i=e.querySelectorAll(".cryptoLink"),o=i.length,s=0;o>s;++s){var a=i[s];a.addEventListener("click",function(e){e.preventDefault();var t=window.utils.decode64(this.getAttribute("data-href")),n=this.getAttribute("data-target");n=null!=n?"_"==n.substring(0,1)?n.substring(1):n:e.ctrlKey?"blank":"self",window[n]?window[n].location.href=t:window.open(t,"_"+n)})}},parseDate:function(e){var t=e||document.body,i=t.querySelectorAll(".momentDate");for(var o in i){var t=i[o];if("object"==typeof t){var s=t.getAttribute("data-date"),a=(t.getAttribute("data-type"),t.getAttribute("data-format")||"LLL");switch(a){case"birthday":var r=n().diff(s,"years"),l=1===r?"an":"ans";r>=0&&1>r&&(l="mois",r=n().diff(s,"month")),s=n(s).format("DD MMMM YYYY")+" ("+r+" "+l+")";break;case"duration":var d=n.duration(1e3*s),c=d.hours(),u=d.minutes(),m=d.seconds(),w="";c>0&&(w+=c+"h "),u>0&&(w+=u+"min "),m>0&&(w+=m+"s"),s=w;break;case"publish":s=n(s).calendar();break;default:s=n(s).format(a)}t.innerHTML=s}}},addIframeListen:function(){var e={};window.addEventListener("message",function(t){var n=this.getFrameTarget(t),i=t.data;if(n&&"resizeIframePub"===i){var o=document.querySelectorAll("iframe");for(var s in o){var a=o[s];n!=a&&a.style&&(a.setAttribute("data-display",a.style.display),a.style.display="none")}n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.bottom=0,n.style.right=0,n.style.zIndex=3e4;var r=document.getElementById("wrapper").currentStyle||window.getComputedStyle(document.getElementById("wrapper"));e={width:n.style.width,height:n.style.height,header:r.marginTop},n.style.width="100%",n.style.height="100%",document.getElementById("wrapper").style.margin=0,document.getElementById("TF1__header").style.display="none",document.getElementById("TF1__menu").style.display="none",document.body.style.overflow="hidden",document.getElementById("live")&&(document.getElementById("live").style.display="none"),window.js_blocks["blocks_sections_content-video"]&&(document.getElementById("content_video").style.display="none",window.js_blocks["blocks_sections_content-video"].setPause()),window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements(),setTimeout(function(){window.scrollTo(0,0)},0)}else if(n&&"closeIframePub"===i){var o=document.querySelectorAll("iframe");for(var s in o){var a=o[s];n!=a&&a.style&&(a.style.display=a.getAttribute("data-display"))}n.style.position="static",n.style.top=0,n.style.left=0,n.style.bottom=0,n.style.right=0,n.style.width=e.width,n.style.height=e.height,n.style.display="none",document.getElementById("wrapper").style.margin=e.header+" 0 0",n.style.zIndex="auto",document.body.style.overflow="auto",document.getElementById("TF1__header").style.display="block",document.getElementById("TF1__menu").style.display="block",document.getElementById("live")&&(document.getElementById("live").style.display="block"),window.js_blocks["blocks_sections_content-video"]&&(document.getElementById("content_video").style.display="block",window.js_blocks["blocks_sections_content-video"].setPlay()),window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements()}else if(n&&"resizeMasthead"===i){var l=document.getElementsByClassName("hasMenuInside").length||0;l>0&&window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements()}else if(n&&"noAds"===i){n.parentNode.removeChild(n);var l=document.getElementsByClassName("hasMenuInside").length||0;l>0&&window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements()}}.bind(this))},getFrameTarget:function(e){for(var t=document.getElementsByTagName("iframe"),n=0,i=t.length;i>n;n++)if(t[n].contentWindow===e.source)return t[n];return null},addJavascriptHeader:function(e){var t=document.getElementById("TF1__header");t&&(e&&this.addJavascriptLinkRedirect(t),require(["blocks/sections/header"],function(e){window.js_blocks["blocks/sections/header"]=new e}),this.addLinksEvents(t),this.parseDate(t))},addJavascriptMenu:function(e){var t=document.getElementById("TF1__menu");t&&(e&&this.addJavascriptLinkRedirect(t),require(["blocks/sections/menu"],function(e){window.js_blocks["blocks/sections/menu"]=new e}),this.addLinksEvents(t),this.parseDate(t))},reevaluateImg:function(){"function"==typeof o&&o({reevaluate:!0})},addJavascriptBlocks:function(e){var t=e.querySelectorAll(".initjs"),n=[];window.js_blocks||(window.js_blocks={});for(var i in t){var o=t[i];if("object"==typeof o&&"undefined"!=typeof o.tagName){var s=o.getAttribute("data-type")||!1,a=window.utils.hasClass(o,"initialized")||!1;s&&n.indexOf(s)<=-1&&(s.split(" ").forEach(function(e){a||require([e.replace(/_/g,"/")],function(t){window.js_blocks[e]=new t})}),n.push(s))}}class_userlib&&(class_userlib.checkTracking(),class_userlib.axciom(),class_userlib.exelate(),class_userlib.finishTrack()),this.lazyloadExtern()},lazyloadExtern:function(){for(var e=document.getElementsByClassName("lazyloadExtern"),t=0,n=e.length;n>t;t++){var i=e[t];if(i.getAttribute("data-html")&&window.utils.isScrolledIntoView(i)){var o=decodeURIComponent(JSON.parse(i.getAttribute("data-html")));i.innerHTML=o,window.utils.insertAndExecute(i,o),i.removeAttribute("data-html"),this.recalculateHeight(i)}}},recalculateHeight:function(e){for(var t=e.querySelectorAll("iframe"),n=0,i=t.length;i>n;n++){var o=t[n];if("100%"===o.style.width){var s=o.offsetWidth,a=9*s/16;o.style.height=a+"px"}}},handlerAds:function(e,t){for(var n=0,i=e.length;i>n;n++){var o=t[e[n]];if(o){if(o.width&&(o.width>=window.innerWidth||"100%"==o.width)){var s=document.getElementById("oas_"+o.position)||!1;s&&window.utils.addClass(s,"mastHead")}if(0==o.width){var s=document.getElementById("oas_"+o.position)||!1;if(s){var a=s.querySelector("iframe")||[];0===a.length&&(s.style.display="none")}}}}if(document.getElementById("oas_Frame1")){var r=document.getElementById("oas_frame_Frame1")||!1;if(r)try{var l=r.contentWindow.document.body.querySelectorAll("img");if(l.length>1)return;if(l=l[0],"https://imageceu1.247realmedia.com/0/TF1_Publicite/27720_DIOR_HOMME_NEW_MAS_91664_PIXEL@Web_Frame1/empty.gif"!==l.src)return;0===l.width&&0===l.height&&(r.style.display="none")}catch(d){}}for(var c=document.getElementsByClassName("withPub"),n=0,i=c.length;i>n;n++){var u=c[n].querySelectorAll(".divAds");for(var m in u){var s=u[m];if("object"==typeof s&&"undefined"!=typeof s.tagName){var w=s.getAttribute("data-position"),_=t[w];_&&"undefined"==typeof _.height?(window.utils.removeClass(s.parentNode,"bg"),window.utils.removeClass(c[n],"withPub")):window.utils.addClass(c[n],"ads600")}}}var y=document.getElementsByClassName("hasMenuInside").length||0;y>0&&window.js_blocks.blocks_sections_menu&&window.js_blocks.blocks_sections_menu.replaceElements()},addJavascriptLink:function(e){if("object"==typeof e&&e.href&&"undefined"!=typeof e.tagName&&(!e.target||"_self"===e.target)&&!window.utils.hasClass(e,"videoLink")&&!window.utils.hasClass(e,"noPajax")&&!window.utils.hasClass(e,"js_filter")){var t=window.utils.parseUri(e.href),n=t.relative,i=/\/direct/.test(n),o=/\/videos\//.test(n),s=t.host;i||l!==s||o||e.addEventListener("click",function(e){e.preventDefault(),document.getElementById("player_video")||document.getElementById("live")&&class_userlib.isAuthenticated()?(window.js_blocks["blocks_sections_content-video"]?(window.js_blocks["blocks_sections_content-video"].activateMini(!0),window.js_blocks["blocks_sections_content-video"].desactivateScroll()):window.js_blocks["blocks_sections_channel-live"]&&(window.js_blocks["blocks_sections_channel-live"].activateMini(!0),window.js_blocks["blocks_sections_channel-live"].desactivateScroll()),_(this.href)):window.location=this.href},!1)}},addJavascriptLinkRedirect:function(e){if("mobile"!==class_userlib.getViewportDevice()&&(document.getElementById("player_video")||document.getElementById("live")&&class_userlib.isAuthenticated())){var t=e.querySelectorAll("a");for(var n in t){var i=t[n];this.addJavascriptLink(i)}}for(var o=document.getElementsByClassName("testCSA"),s=0,a=o.length;a>s;s++){var r=o[s],l=r.getAttribute("data-csa")||!1;if(l){var d=r.querySelector(".csa");d.setAttribute("data-csa",l),d.innerHTML=l,d.style.display="block"}}},setCredits:function(){var e={footer:document.getElementById("TF1__footer")},t=[].slice.call(document.querySelectorAll(".img_mytf1")),n=function(){for(var e=-1,n=t.length,i=[];++e<n;){var o=t[e].getAttribute("data-credit");o&&-1===i.indexOf(o)&&i.push(o)}return i}();if(n.length>0){var i=document.createElement("p");e.footer.querySelector("#last_list_links").appendChild(i),n.forEach(function(e,t){0===t?i.innerHTML="Crédits Photos : ":i.innerHTML+=" | ",i.innerHTML+=e})}}},a});