var sas=sas||{};sas.banner=sas.banner||{};sas.creativeType={REDIRECT:0,IMAGE:1,FLASH:2,FLV:3,HTML5:4};(function(){var a={};sas.events.addEvent(window,"message",function(q){if(!q.data||!a[q.data]){return}q.source.postMessage(a[q.data].clickUrl,"*")});var h=function(r,s){var q=document.createElement("a");q.href=r;q.target=s;return q};var f=function(s,t,q){var r=document.createElement("iframe");r.id=s;r.scrolling="no";r.frameBorder=0;r.width=t;r.height=q;r.style.margin=0;r.style.padding=0;r.style.width=t+"px";r.style.height=q+"px";return r};var c=function(r,w){if(!w){return}else{var q=document.createElement("div");q.innerHTML="_"+w;var u=1;while(u<q.childNodes.length){var v=q.childNodes[u];if(v.tagName=="SCRIPT"){var x=document.createElement("script");x.type="text/javascript";x.defer="defer";if(!v.src){x.text=v.text}else{x.src=v.src}v=x;u++}r.appendChild(v)}}};var n=function(q){var r=q.instanceIndex>1?"_"+q.instanceIndex:"";return q.tagId||("sas_"+q.formatId+r)};var k=function(s,q,u){var r=q.creatives[0];var v=r.url+(r.url.indexOf("?")<0?"?":"&")+"sasfid="+q.formatId;var t=f("sas_"+q.id+"_iframe",r.width,r.height);t.src=v;sas.events.addLoadEvent(t,function(){u(t)});s.appendChild(t);c(s,r.creativeScript+q.customScript)};var m=function(t,q,w,x){var r=q.creatives[0];if(!x.async){document.write(r.creativeScript+q.customScript)}else{var u=f("sas_"+q.id+"_iframe",r.width,r.height);sas.events.addLoadEvent(u,function(){w(u)});t.appendChild(u);var s=u.contentDocument||u.contentWindow.document;s.write('<body style="margin:0;padding:0"><script type="text/javascript">var inDapIF=inDapMgrIf=true;</script>'+r.creativeScript+q.customScript+"</body>");var v=sas.utils.getIEVersion();if(!v||v>9){s.close()}}};sas.utils=sas.utils||{};sas.utils.getIEVersion=function(){var q=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return q?parseInt(q[1]):undefined};var g=function(r,u){var t=document.createElement("img");var s=t;var v=parseInt(r.pixelRatio)||1;sas.events.addLoadEvent(t,function(){u(t)});t.id=r.id;t.src=r.url;t.alt=r.altText;t.width=r.width/v;t.height=r.height/v;t.border=0;if(!!r.clickUrl){var q=document.createElement("a");q.href=r.clickUrl;q.target=r.clickTarget;q.appendChild(t);s=q}return s};var b=[];var p=function(q){if(q!=null){b.push(q)}};sas.events.addLoadEvent(document,function(){_loaded=true;b.push=function(r){r()};for(var q=0;q<b.length;q++){b[q]()}});var e=function(s,u){var t;var r={id:s.id+"Object",height:s.height,width:s.width};var w={quality:"high",allowScriptAccess:"always",wmode:s.wMode||"window",swLiveConnect:true,flashVars:s.flashVars||""};if(sas.utils.getIEVersion()<11){t=(function(){var y=document.createElement("div");y.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' type='application/x-shockwave-flash'><param name='movie' value='"+s.url+"'><param name='wmode' value='"+w.wmode+"'><param name='flashVars' value='"+w.flashVars+"'></object>";return y.firstChild})();delete w.wmode;delete w.flashVars;sas.events.addLoadEvent(t,function(){u(t)})}else{t=document.createElement("object");r.type="application/x-shockwave-flash";r.data=s.url;p(function(){u(t)})}for(var q in r){t[q]=r[q]}for(var v in w){if(w[v]){var x=document.createElement("param");x.name=v;x.value=w[v];t.appendChild(x)}}return t};var l=function(t,q,u){var r=q.creatives[0];var s=g(r,u);t.appendChild(s);c(t,r.creativeScript+q.customScript)};var j=function(t,q,v){var r=q.creatives[0];var u=(r.version&&r.version<=sas.Browser.Flash.version);if(!u&&(!r.backupImage||!r.backupImage.url)){return}var s=u?e(r,v):g(r.backupImage,v);t.appendChild(s);c(t,r.creativeScript+q.customScript)};var d={};d[sas.creativeType.REDIRECT]=m;d[sas.creativeType.IMAGE]=l;d[sas.creativeType.FLASH]=j;d[sas.creativeType.HTML5]=k;var i=function(q){var r=parseInt(Math.random()*100000000);var s=q.oba==2?"top-left":"top-right";sas.utils.loadLinkCdn("diff/templates/js/adplayer/adplayer.css");sas.utils.loadScriptCdn(["diff/templates/js/adplayer/adplayer.js","diff/templates/js/adplayer/adplayer.sas.js"],{onLoad:function(){$ADP.sas.addOba(q.formatId,false,s,r,q.formatId,r)}})};var o=function(t,q,u){var v=new sas.utils.Latch(["creaLoaded","viewabilityLoaded"]);v.addListener(function(w){sas.viewability.register(w,function(){new Image().src=q.viewability.viewUrl},{duration:q.viewability.duration,area:q.viewability.area,onError:function(){new Image().src=q.viewability.errorUrl}})});var r=q.creatives[0];var s=d[r.type](t,q,function(w){v.notify("creaLoaded",w)},u);if(r.countUrl){new Image().src=r.countUrl}if(q.viewability&&q.viewability.enabled){sas.utils.loadScriptCdn("diff/templates/js/sas/sas-viewability.js",{onLoad:function(){v.notify("viewabilityLoaded")}})}if(q.oba){i(q)}};sas.banner.render=function(q,u){u=u||{};u.async=u.async==null?true:u.async;if(!q.creatives||!q.creatives.length){throw new Error("No creative found for config "+q.id)}var r=q.creatives[0];q.tagId=n(q);a[q.formatId]=r;var s=document.getElementById(q.tagId);if(!s){throw new Error("No element with id "+q.tagId+" found")}if(r&&!d[r.type]){throw new Error("Unsupported banner type "+r.type)}if(q.forcedIframeWidth>0&&q.forcedIframeHeight>0){var t=f("sas_i"+q.tagId,q.forcedIframeWidth,q.forcedIframeHeight);sas.events.addLoadEvent(t,function(){var v=t.contentDocument||t.contentWindow.document;v.body.style.margin=0;v.body.style.padding=0;o(v.body,q,u)});s.appendChild(t)}else{o(s,q,u)}}})();