define(["lib/uaparser"],function(e){"use strict";function t(){return this.tabXitiAlreadySent=[],this.alreadySentXiti=!1,this.alreadySentLogged=!1,this.alreadySentUnlogged=!1,this.windowWidth=window.innerWidth,i=new e,o=i.getResult(),this}var i=!1,o=!1;return t.prototype={getDevice:function(){return i.getDevice()},getOS:function(){return o.os},getBrowser:function(){return o.browser},getViewportDevice:function(){var e="desktop";return this.windowWidth<767?e="mobile":this.windowWidth<1024&&(e="tablet"),e},isSupportedBrowser:function(){var e=this.getBrowser();return"IE"==e.name&&e.major<9?!1:"Firefox"==e.name&&e.major<10?!1:"Safari"==e.name&&e.major<5?!1:!0},isAuthenticated:function(){var e=this.getCookie("isAuthenticated");return null!==e&&""!==e&&1==e?!0:!1}},t.prototype.getCookie=function(e){return e?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},t.prototype.setCookie=function(e,t,i,o,n,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(i)switch(i.constructor){case Number:a=i===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+i;break;case String:a="; expires="+i;break;case Date:a="; expires="+i.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(n?"; domain="+n:"")+(o?"; path="+o:"")+(r?"; secure":""),!0},t.prototype.removeCookie=function(e,t,i){return this.hasCookie(e)?(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(i?"; domain="+i:"")+(t?"; path="+t:""),!0):!1},t.prototype.hasCookie=function(e){return e?new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie):!1},t.prototype.getAllCookies=function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,i=0;t>i;i++)e[i]=decodeURIComponent(e[i]);return e},t.prototype.checkTracking=function(){var e=this.getCookie("dxSent");if(e){var t=e.split("#"),i=[];if(t[0]&&(this.alreadySentUnlogged=!0),t[1]&&(this.alreadySentLogged=!0),i=t[0],this.isAuthenticated()&&(i=t[1]),i){this.tabXitiAlreadySent=i.split(",");for(var o=this.tabXitiAlreadySent.length,n=0;o>n;n++)if(this.tabXitiAlreadySent[n]==xtsite||this.tabXitiAlreadySent[n]==xtn2){this.alreadySentXiti=!0;break}}}},t.prototype.exelate=function(){if(!this.alreadySentXiti){var e=1,t="",i="";1==e?(e="001",t=xtsite,i=xtn2):t=xtn2;var o="&g="+e+"&CMS="+t;if(i&&(o+="&subctg="+i),this.isAuthenticated()){var n=class_userlib.getCookie("session"),r=JSON.parse(utils.decode64(n));o+="&puid="+r.mso.idMD5;var a="male"===r.mso.sex?1:2;a&&(o+="&gd="+a);var s=r.mso.zipcode;s&&(o+="&zip="+s);var c=r.mso.birthdate;if(c){var d=new Date,u=0,p=c.substr(6,4),h=d.getFullYear();u=h-p;var l=d.getMonth()-c.substr(3,2);0>l?u-=1:0==l&&d.getDay()-c.substr(0,2)>0&&(u-=1),u>=13&&120>u&&(o+="&ag="+u)}}utils.evalScript({src:"https://loadeu.exelator.com/load/?p=268"+o+"&j=d"}),this.tabXitiAlreadySent.push(t)}},t.prototype.axciom=function(){if(this.isAuthenticated()&&!this.alreadySentLogged){var e=class_userlib.getCookie("session"),t=JSON.parse(utils.decode64(e)),i=t.mso.mailMD5||!1,o=document.createElement("iframe");o.name="_acxiom",o.width=0,o.height=0,o.src="https://p-eu.acxiom-online.com/pixel/ema?eml="+i+"&ha=md5&pid=2011&sc=mytf1&t=201101&ot=iframe;",document.body.appendChild(o)}},t.prototype.finishTrack=function(){var e=["",""],t=this.getCookie("dxSent");t&&(e=t.split("#"));var i="";i=this.isAuthenticated()?e[0]+"#"+this.tabXitiAlreadySent.join(","):this.tabXitiAlreadySent.join(",")+"#"+e[1],this.setCookie("dxSent",i)},t});