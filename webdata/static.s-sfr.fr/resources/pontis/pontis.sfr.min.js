var pontis={settings:new Object(),requests:new Array(),arrowBlockIds:["web_vitrine_btiq","WP_Portail_HpMC_info_Arrow","WP_Portail_HpMC_btiq_Arrow","web_mess_info","web_ec_btiq","web_portail_btiq","web_vitrine_info","web_vitrine_mea_btiq","WP_HpMC_PopAppli_Arrow","web_live_festival","web_live_hp","web_live_concert","web_music_btiq","web_portail_vod","web_portail_tv"],arrowRequests:new Array(),timeOut:null,timeOutCalled:false,sent:false,acknowledgeCalls:{campaignIds:new Array(),blockIds:new Array()},_init:function(B){this.settings={context:"",domain:"//pontis.sfr.fr/proxy/",checkerTimeout:300,errorTimeout:3000};
var A=window.location.href;var D=window.location.href.indexOf("ctxPontis=");if(D>0){this.settings.context=A.substring(D+10,(A+"&").indexOf("&"));
}if(this.settings.context=="VABF"){this.settings.domain="//84.37.85.230/proxy/";}if(this.settings.context=="TEST"){this.settings.domain="//frparpontisprxweb.capgemini.fr/proxy/";
}this.settings.blockURL=this.settings.domain+"banner-request";this.settings.ackURL=this.settings.domain+"ack-request";
this.settings.clickURL=this.settings.domain+"click-request";if(B!=null){for(var C in B){this.settings[C]=B[C];
}}},request:function(C){if(typeof stat_js=="function"){stat_js("//www.sfr.fr/recherche/js/log.js?PONTIS="+escape(C.blockId));
}if(C){if(!C.containerSelector){C.containerSelector=C.blockId;}if(C.containerSelector.indexOf("#")==0){C.containerSelector=C.containerSelector.slice(1);
}var B=false;for(var A=0;A<this.arrowBlockIds.length;A++){if(this.arrowBlockIds[A]==C.blockId){B=true;
break;}}if(B){this.arrowRequests.push(C);}else{this.requests.push(C);}}},_sendRequests:function(){if(!this.sent&&(this.requests.length>0||this.arrowRequests.length>0)){for(var C=0;
C<this.arrowRequests.length;C++){arrow.request(this.arrowRequests[C]);}var H=[];for(var C=0;
C<this.requests.length;C++){H.push(escape(this.requests[C].blockId));}if(H.length>0){var A=typeof window.zvars=="undefined"?[]:window.zvars;
var E=typeof window.s=="undefined"?0:window.s;this.settings.v4=typeof A["eVar4"]=="undefined"?"":escape(A["eVar4"]);
this.settings.v5=typeof A[5]=="undefined"?"":escape(A[5]);this.settings.v18=typeof A[18]=="undefined"?"":escape(A[18]);
this.settings.v19=typeof A[19]=="undefined"?"":escape(A[19]);this.settings.v20=typeof A[20]=="undefined"?"":escape(A[20]);
var B=document.cookie;var G=(" "+B).indexOf(" evar28=");this.settings.v28=(G<0)?"refus_cookie":B.substring(G+7,(B+";").indexOf(";",G));
this.settings.pageName=E&&E.pageName?E.pageName:document.URL;var C=(" "+B).indexOf(" ext_ref=");
var F=(C<0)?"":B.substring(C+8,(B+";").indexOf(";",C));var D=this.settings.blockURL;
D+="?idBlockContent="+H.join("|");D+="&evar4="+this.settings.v4+"&evar5="+this.settings.v5+"&evar28="+this.settings.v28;
D+="&pageName="+escape(this.settings.pageName);D+="&referer="+F;D+="&evar18="+this.settings.v18+"&evar19="+this.settings.v19+"&evar20="+this.settings.v20;
this._addScriptTag(D);this.timeOut=setTimeout("pontis._showDefaultContent()",this.settings.errorTimeout);
}this.sent=true;}},response:function(jsonResponse){if(!this.timeOutCalled){clearTimeout(this.timeOut);
var json=jsonResponse;for(var i=0;i<this.requests.length;i++){var request=this.requests[i];
if(json[request.blockId]){eval("contenu"+request.blockId+" = {done:1}");this._showBanner(json[request.blockId],request);
}}this._sendPontisAcknowledge();this.acknowledgeCalls.campaignIds=new Array();this.acknowledgeCalls.blockIds=new Array();
}},_showDefaultContent:function(request){if(request!=null){document.getElementById(request.containerSelector).innerHTML=request.defaultText;
}else{this.timeOutCalled=true;for(var i=0;i<this.requests.length;i++){var requestInfos=this.requests[i];
if(eval("typeof contenu"+requestInfos.blockId)=="undefined"){eval("contenu"+requestInfos.blockId+" = {done:1}");
document.getElementById(requestInfos.containerSelector).innerHTML=requestInfos.defaultText;
if(typeof requestInfos.callback=="function"){requestInfos.callback();}}}}},_showBanner:function(C,I){var F='javascript:return pontis._sendPontisClick({blockId: "'+I.blockId+'", campaignId: "'+C.idCampagne+'", isNewWindow: '+I.isNewWindow+", pageUrl: this.href });";
var E={blockId:I.blockId,campaignId:C.idCampagne,isNewWindow:I.isNewWindow,pageUrl:C.urlPageCible};
switch(C.typeContenu){case"image":if(C.urlContenu!=""&&C.urlPageCible!=""){var D=new RegExp('"',"g");
var G=C.texte.replace(D,"'");var B=document.createElement("a");B.href=C.urlPageCible;
B.onclick=function(){return pontis._sendPontisClick(E);};B.title=G;var H=document.createElement("img");
H.src=C.urlContenu;H.alt=G;B.appendChild(H);document.getElementById(I.containerSelector).appendChild(B);
this._storeAcknowledgeCalls(C.idCampagne,I.blockId);}break;case"html":if(C.texte!=""){var D=new RegExp('<a( [^>]*)? href="([^"]*)"',"gi");
var A=C.texte.replace(D,'<a$1 href="$2" onclick=\''+F+"'"+(I.isNewWindow?' target="_blank"':""));
document.getElementById(I.containerSelector).innerHTML=A;this._storeAcknowledgeCalls(C.idCampagne,I.blockId);
}break;case"erreur":this._showDefaultContent(I);break;}if(typeof I.callback=="function"){I.callback();
}},_storeAcknowledgeCalls:function(A,B){this.acknowledgeCalls.campaignIds.push(A);
this.acknowledgeCalls.blockIds.push(B);},_sendPontisAcknowledge:function(){var C=this.settings.ackURL,A=this.acknowledgeCalls.campaignIds.join("|"),B=this.acknowledgeCalls.blockIds.join("|");
if(A&&B){C+="?idCampagne="+A;C+="&idBlockContent="+B;C+="&evar28="+this.settings.v28;
C+="&evar4="+this.settings.v4;C+="&evar5="+this.settings.v5;this._addScriptTag(C);
}},_sendPontisClick:function(A){var B=this.settings.clickURL;B+="?idCampagne="+A.campaignId;
B+="&idBlockContent="+A.blockId;B+="&evar28="+this.settings.v28;B+="&evar4="+this.settings.v4;
B+="&evar5="+this.settings.v5;this._addScriptTag(B,function(){if(!A.isNewWindow){document.location.href=A.pageUrl;
}});return A.isNewWindow;},_addScriptTag:function(B,C){var A=document.createElement("script");
A.setAttribute("type","text/javascript");A.setAttribute("src",B);A.setAttribute("async","true");
document.getElementsByTagName("head")[0].appendChild(A);if(C!=null){if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){A.onreadystatechange=function(){if(this.readyState=="loaded"){C();
}};}else{A.onload=C;}}}};if(!window.arrow){var arrow={_init:function(A){},request:function(request){var zvars=typeof window.zvars=="undefined"?[]:window.zvars;
var ascId=typeof zvars["eVar4"]=="undefined"?"":escape(zvars["eVar4"]);var browserId=this._getCookie("evar28");
var previewBlockId=this._getRequestParam("previewBlockId");var previewCommunicationId=this._getRequestParam("previewCommunicationId");
var c=this._getCookie("eTagArrow"),baseUrl="//"+(c==2?"192.168.0.149:8080/arrow-front/":(c==3?"www.sfr.fr.ipp2":c==1?"cms":"www")+".sfr.fr/arrow/");
var getUrl=baseUrl+"banner";var getData={blockId:request.blockId,browserId:browserId,ascId:ascId};
if(previewCommunicationId&&previewBlockId&&previewBlockId==request.blockId){getUrl=baseUrl+"preview";
getData={blockId:request.blockId,communicationId:previewCommunicationId,browserId:browserId,ascId:ascId};
}JSONP.get(getUrl,getData,function(){var sel=request.containerSelector;if((!sel||!document.getElementById(sel))&&typeof stat_js=="function"){stat_js("//www.sfr.fr/recherche/js/log.js?DIV_KO="+escape(request.blockId));
}document.getElementById(request.containerSelector).innerHTML=request.defaultText.replace(/ src=(['"])https?:\/\//g," src=$1//");
if(typeof request.containerSelector2!="undefined"&&request.containerSelector2!=null&&request.containerSelector2!=""&&typeof request.defaultText2!="undefined"&&request.defaultText2!=null&&request.defaultText2!=""){document.getElementById(request.containerSelector2).innerHTML=request.defaultText2.replace(/ src=(['"])https?:\/\//g," src=$1//");
}if(typeof request.callback=="function"){request.callback();}if(typeof stat_js=="function"){stat_js("//www.sfr.fr/recherche/js/log.js?BOUCHON="+escape(request.blockId));
}},function(data){var sel=request.containerSelector;if((!sel||!document.getElementById(sel))&&typeof stat_js=="function"){stat_js("//www.sfr.fr/recherche/js/log.js?DIV_KO="+escape(request.blockId));
}document.getElementById(request.containerSelector).innerHTML=data.html.replace(/ src=(['"])https?:\/\//g," src=$1//");
var scripts=document.getElementById(request.containerSelector).getElementsByTagName("script");
for(var i=0;i<scripts.length;i++){eval(scripts[i].text);}var links=document.getElementById(request.containerSelector).getElementsByTagName("a");
var clickFunc=function(e){var link=e.target||e.srcElement;while(link.tagName!="A"){link=link.parentNode;
}var img=document.createElement("img");img.src=baseUrl+"click?blockId="+request.blockId+"&campaignId="+data.campaignId+"&browserId="+browserId+"&ascId="+ascId;
document.body.appendChild(img);var href=link.href;var target=link.target;var hasAuthentClass=link.className&&new RegExp("(^|\\s)authent(\\s|$)").test(link.className);
img.onload=img.onerror=function(evt2){if(target=="_blank"||target=="_new"||hasAuthentClass){}else{if(target=="_top"){parent.location=href;
}else{document.location=href;}}img.parentNode.removeChild(img);};if(target!="_blank"&&target!="_new"&&!hasAuthentClass){if(e.preventDefault){e.preventDefault();
}else{e.returnValue=false;}}};for(var i=0;i<links.length;i++){var link=links[i];if(document.addEventListener){link.addEventListener("click",clickFunc,false);
}else{if(document.attachEvent){link.attachEvent("onclick",clickFunc);}}}if(typeof request.containerSelector2!="undefined"&&request.containerSelector2!=null&&request.containerSelector2!=""&&typeof request.defaultText2!="undefined"&&request.defaultText2!=null&&request.defaultText2!=""){document.getElementById(request.containerSelector2).innerHTML=data.html2.replace(/ src=(['"])https?:\/\//g," src=$1//");
}if(typeof request.callback=="function"){request.callback();}});},_getRequestParam:function(A){var B=(new RegExp("[?&]"+encodeURIComponent(A)+"=([^&]*)")).exec(location.search);
if(B){return decodeURIComponent(B[1]);}else{return null;}},_getCookie:function(B){var D=B+"=";
var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length);
}if(E.indexOf(D)==0){return E.substring(D.length,E.length);}}return"refus_cookie";
}};}var JSONP=(function(){var A=0,C,F,B,D=this;function E(K,L,J){var I=document.createElement("script");
var H=false;I.src=K;I.async=true;I.onerror=function(){if(!H){H=true;I.onload=I.onreadystatechange=I.onerror=null;
if(I&&I.parentNode){I.parentNode.removeChild(I);}}try{delete D[L];}catch(M){}D[L]=null;
J();};I.onload=I.onreadystatechange=function(){if(!H&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){H=true;
I.onload=I.onreadystatechange=null;if(I&&I.parentNode){I.parentNode.removeChild(I);
}}};if(!C){C=document.getElementsByTagName("head")[0];}C.appendChild(I);}function G(I,L,H,M){F="?";
L=L||{};for(B in L){if(L.hasOwnProperty(B)){F+=encodeURIComponent(B)+"="+encodeURIComponent(L[B])+"&";
}}var K="json"+(++A);D[K]=function(N){M(N);try{delete D[K];}catch(O){}D[K]=null;};
H=H||function(){};var J=(typeof M=="undefined")?"":"callback="+K;E(I+F+J,K,H);D.setTimeout(function(){if(typeof D[K]=="function"){D[K]=function(N){try{delete D[K];
}catch(O){}D[K]=null;};H();D.setTimeout(function(){if(typeof D[K]=="function"){try{delete D[K];
}catch(N){}D[K]=null;}},10000);}},3000);return K;}return{get:G};}());function requetePontisContenu(B,C,A){pontis.request({blockId:B,defaultText:C,isNewWindow:A!=0});
}function blocPontis(B,C,A){document.writeln('<div id="'+B+'"></div>\n');pontis.request({blockId:B,defaultText:C,isNewWindow:A!=0});
}pontis._init();arrow._init&&arrow._init();