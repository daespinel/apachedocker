define(["lib/hammer"],function(e){function n(){return this.initMenu(),window.addEventListener("scroll",function(){this.eventScroll()}.bind(this)),this.eventScroll(),this}var t={body:null,header:null,menu:null,buttons:null,menuBtnChannel:null,menuBtnProgram:null},l={channelMenuOpened:!1,programMenuOpened:!1,breakpoint:null};return n.prototype.displayMenu=function(e){switch(e){case"menu_btn_channel":l.channelMenuOpened?(utils.removeClass(t.body,"menu-channel-opened"),l.channelMenuOpened=!1):(utils.addClass(t.body,"menu-channel-opened"),utils.removeClass(t.body,"menu-program-opened"),l.channelMenuOpened=!0,l.programMenuOpened=!1);break;case"menu_btn_program":l.programMenuOpened?(utils.removeClass(t.body,"menu-program-opened"),l.programMenuOpened=!1):(utils.addClass(t.body,"menu-program-opened"),utils.removeClass(t.body,"menu-channel-opened"),l.programMenuOpened=!0,l.channelMenuOpened=!1)}},n.prototype.eventScroll=function(){l.breakpoint&&utils.scrollY()>l.breakpoint?utils.addClass(t.body,"menu-scrolled"):!l.breakpoint&&utils.scrollY()>0?utils.addClass(t.body,"menu-scrolled"):utils.removeClass(t.body,"menu-scrolled")},n.prototype.initElements=function(e){t.body=document.getElementsByTagName("body")[0],t.header=document.getElementById("TF1__header"),t.menu=document.getElementById("TF1__menu"),t.buttons=[].slice.call(document.getElementsByClassName("menu_btn")),t.menuBtnChannel=document.getElementById("menu_btn_channel"),t.menuBtnProgram=document.getElementById("menu_btn_program")},n.prototype.replaceElements=function(){var e=t.body.getAttribute("class")&&t.body.getAttribute("class").match(/(\bskin_)\w+\b/g)?t.body.getAttribute("class").match(/(\bskin_)\w+\b/g)[0]:"skin_default",n=!1,o=!1;switch(e){case"skin_homepage":n=document.getElementById("caroussel");break;case"skin_showpage":n=document.getElementById("cover")}if(n){o=n.offsetTop+n.offsetHeight;var s=utils.getOffset(n).top-utils.getOffset(document.getElementById("wrapper")).top;t.menu.style.top=s+"px"}l.breakpoint=o},n.prototype.initMenu=function(){this.initElements(),this.setActiveLink(),t.buttons.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),this.displayMenu(e.currentTarget.id)}.bind(this))}.bind(this)),document.getElementById("close_menu_program")&&document.getElementById("close_menu_program").addEventListener("click",function(e){this.displayMenu("menu_btn_program")}.bind(this)),document.getElementById("close_menu_channel")&&document.getElementById("close_menu_channel").addEventListener("click",function(e){this.displayMenu("menu_btn_channel")}.bind(this)),l.channelMenuOpened=!1,l.programMenuOpened=!1,this.activateTransition()},n.prototype.activateTransition=function(){var e=class_userlib.getBrowser();"IEMobile"==e.name&&e.major<=10||utils.addClass(t.menu,"transition_allowed")},n.prototype.setActiveLink=function(){var e=utils.parseUri(window.location),n=e.directory,l=e.relative,o=[].slice.call(t.menu.querySelectorAll('[href="'+l+'"]'));o&&o.forEach(function(e){utils.addClass(e,"selected")});var o=[].slice.call(t.menu.querySelectorAll('[href="'+n+'"]'));o&&o.forEach(function(e){utils.addClass(e,"selected")})},n});